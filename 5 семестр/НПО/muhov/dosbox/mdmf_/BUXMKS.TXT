 Н0
      ш1
      В58
.
                              - 1 -

                                                   buxmks.txt
                     Лабораторная работа
          Проектирование и создание упррощенной системы
        бухгалтерского учета на базе кнтги счетов в среде FoxPro

     ВЫПОЛНЕНИЕ РАБОТЫ.
     1.1. Создать рабочий каталог  по  первым  буквам  фамилии  на
рабочем диске указанном преподавателем (как правило, диск E).
     1.2. Загрузить FoxPro.  В каталоге FPD26  найти  и  запустить
программу  foxpro.exe или foxprox.exe.  Просмотреть системное меню
(F10).
      Здесь и в дальнейшем при указании имени текстового файла или
создаваемых баз данных (копирование,  сортировка и т.д.) указывать
ПОЛНОЕ ИМЯ С УКАЗАНИЕМ ПУТИ ДОСТУПА.

     2. Создание картотек
     2.1. C  использованием  мышки создать картотеки (базы данных)
Книга счетов (ks_.dbf) (F10,  File,  Open,  выбрать Type=Database,
выбрать  New).  Установить  текущий каталог для работы (установить
текущий диск в поле Drive,  текущий  каталог  в  поле  Directory).
Ввести  ранее  разработанную структуру по шаблону Name(имя),  Type
(тип  данных  с-символьное  n-цифровое),  Width(размерность),  Dec
(знаков после запятой) и сохранить созданные картотеки под именами
KS_ и CD_ (Ok,  появится новое окошко где ввести имя  картотеки  в
поле DBF и выбрать Save).

        Описаните картотеки книга счетов (ks_)
     поле программиста   ks_0       n1    всегда=0
     дата документа      ks_data    d
     тип документа       ks_dokt    c3
     номер документа     ks_dokn    n10
     описание операции   ks_txt     c25
     счет                ks_s       n2
     аналитика вид       ks_antyp   c5
     аналитика код       ks_ankod   с15
     корреспонд.счет     ks_ks      n2
     дб                  ks_db      n10
     кр                  ks_kr      n10

     При запросе  ввода  записей выйти из режима ввода (отработать
мышкой квадратик в левом верхнем углу экрана или ESC).

     2.2. Аналогично  2.1  создать  картотеку  Управление  работой
(cd_.dbf).

         Описание картотеки Управление работой (cd_)
     поле программиста   cd_0       n1    всегда=0
     интервал (дата c)   cd_datas   d
     интервал (дата до)  cd_datado  d
     счет                cd_s       n2
     аналитика вид       cd_antyp   c5
     аналитика код       cd_ankod   с15

     2.3. Отработать  на  картотеке ПРОСМОТР СТРУКТУРЫ КАРТОТЕКИ =
ОПРЕДЕЛЕНИЕ   КАРТОТЕКИ   =   ОПРЕДЕЛЕНИЕ   РЕКВИЗИТОВ   КАРТОТЕКИ
(Database,   Setup)  и  ПРОСМОТР  ДАННЫХ  КАРТОТЕКИ  =  СОДЕРЖИМОЕ
КАРТОТЕКИ (Database, Browse).
     При работе с окнами отработать с использованием мышки переме-
щение окон (захват окна мышкой на верхнем колонтитуле и перетаски-
вание окна),  изменение размеров окон (мышка в правый нижний угол,
"захват" угла и его перетаскивание мышкой),  вывод окна на  полный
экран (мышка в правый верхний угол и нажатие кнопки), выход и зак-
рытие окна (мышка в левый верхний угол и нажатие кнопки).
     В режиме  просмотра  (BROWSE)  переключить режимы отображения
(Browse, Browse),  (Browse, Change) или (Browse, Append), (Browse,
Grid on), (Browse, Grid off)

     3.  Создание экранных форм
     3.1. C  использованием  мышки  создать  экранную  форму КНИГА
СЧЕТОВ (kssxx). Для этого сначала создать непоименованную экранную
форму   untitled   (непоименованная)  (F10,  File,  Open,  выбрать
Type=Screen, выбрать New).
     Нарисовать на  экране рамку (зафиксировать мышкой левый верх-
ний угол,  выбрать Screen,  выбрать Box,  "растянуть" мышкой рамку
(движение правого нижнего угла), отпустить кнопку мышки ).
     Отработать создание текста на  экранной  форме,  например,  в
середине рамки  сделать  надпись  "КНИГА  СЧЕТОВ"   (зафиксировать
мышкой  начало текста (установить курсор мышки в требуемую позицию
и нажать кнопку мышки), ввести текст, нажать Ввод ).
     Создать кнопку программного вызова "выход из экранной  формы"
(зафиксировать мышкой начало текста кнопки,  выбрать Screen,  выб-
рать Push Button, в поле Push button prompt ввести название кнопки
"ВЫХОД" ,  в поле Choose набрать m.end,  выбрать Valid, в поле для
ввода операций (переход с помощью мышки) набрать cancel, OK, OK).
     Установить процедуру  начального входа в экранную форму (выб-
рать Screen,  выбрать Screen Layout, выбрать Setup, Ok, в окне Un-
titled Setup  ввести и сохранить(выход по левому верхнему углу ок-
на) процедуру начальной установки

    close all
    clear
    select 1
    use ks_

    Сохранить untutled  экран  под  именем  kssxx  (выбрать  File,
выбрать Save As,  набрать имя экранной формы в нижнем поле экрана,
выбрать Save, Yes)
    Сгенерировать программный текст на выполнение  экранной  формы
(выбрать Program, выбрать Generate, выбрать Generate, Yes (при не-
обходимости) при запросе на сохранение измененного экрана).
     Запустить программу  вывода экранной формы kssxx.spr (выбрать
Program, выбрать Do, указать курсором мышки программу kssxx.SPR на
выполнение и дважды нажать кнопку мышки).
     По отработке  (появлению)  экрана выйти из него (выбрать поле
ВЫХОД).
     Отработать вызов экранной формы несколько раз.
     При возникновении проблемм обратиться к преподавателю.
     Выйти из среды Foxpro (выбрать File, выбрать Quit).

     3.2. Аналогично 3.1 создать экранную форму УПРАВЛЕНИЕ РАБОТОЙ

     3.3. Расширить экранную форму kssxx.
     Загрузить Foxpro (см.выше). Отработать выбор картотеки ( выб-
рать File, выбрать Open, выбрать Database, указать мышкой картоте-
ку. Загрузить экран kssxx (выбрать  File,  выбрать  Open,  выбрать
Type=Screen, указать мышкой требуемый экран,  нажать двыжды кнопку
мышки), сохранить  экранную  форму  под  именем  kssxx  (см.выше).
     Модифицировать экранную форму kssxx, а именно,
     изменить размер рамки (отработать мышкой  на  рамке,  Delete,
создать новую рамку (см.выше)),
     вставить текст КАРТОЧКА (см. выше),
     вставить отображаемое  поле  ks_0  (выбрать  Screen,  выбрать
Field,  выбрать <Get>,  указать отбражаемое поле картотеки в  поле
Database  Field  с последующим двойным нажатием кнопки мышки,  OK,
выбрать  ()Say,  выбрать   Refresh,   Ok),
     вставить оставшиеся   редактируемые   поля  (выбрать  Screen,
выбрать Field, выбрать <Get>, указать редактируемое поле картотеки
в поле Database Field с последующим двойным нажатием кнопки мышки,
выбрать Valid и набрать в появившемся окне SHOW GETS , OK, OK ).
    Отработать перемещение  полей  по  экрану  (выбор   мышкой   и
классическое  перетаскивание).  Отработать  удаление  полей (выбор
поля мышкой и Delete).  Отработать изменение размера полей  (выбор
поля  мышкой,  Enter,  Ctrl+пробел,  курсор  вправо  (или  влево),
Еnter).
     Сохранить полученную экранную форму  (выбрать  File,  выбрать
Save). Сгенерировать программный текст экранной формы (см. выше) и
отработать его на выполнение (см.выше).
    Добавить кнопку программного вызова СЛЕДУЮЩАЯ ЗАПИСЬ (см.выше)
с вызовом программы

     skip
     show gets

     Добавить кнопку программного вызова ПРЕДЫДУЩАЯ ЗАПИСЬ с вызо-
вом программы

     skip -1
     show gets

     Добавить кнопку программного вызова ДОБАВИТЬ ЗАПИСЬ с вызовом
программы

     append
     show gets

     Добавить кнопку  программного вызова ПРОСМОТР КАРТОТЕКИ с вы-
зовом программы

  define window browse_xx ;
	from 0,1 to 24,79 ;
        nofloat none shadow

  activ window browse_xx

  browse normal  ledit;
     noappend nomenu ;
     window browse_xx ;
     title " картотека КНИГА СЧЕТОВ "

  release window browse_xx

  show gets

     Сохранить экранную  форму.  Отработать генерацию программного
текста экранной формы и его вызов (см.выше)
     Выйти из среды Foxpro.

     4. Создание печатных форм
     4.1. Создание   выходной   формы   КНИГА  СЧЕТОВ  (распечатка
несортированной картотеки).
     Загрузить Foxpro.  Отработать выбор картотеки (выбрать File,
выбрать Open,  выбрать  Type=Database,  указать мышкой картотеку c
последующим двойным нажатием кнопки мышки).
     C использованием мышки создать отчет untitled  (непоименован-
ный) (выбрать File, Open, выбрать Type=Report, выбрать New).
     Определить уровень 0 отчета  (выбрать  Report,  выбрать  Data
Grouping, выбрать  <Add>,  выбрать  <Group>,  указать  поле ks_0 в
качестве переменой уровня в окне Field Name c последующим  двойным
нажатием кнопки мышки, OK, OK).
     Написать заголовок формы на  уровне  PgHead  следующего  вида

     БФ ИСЗ                                      ф.ksrxx
                        Книга счетов
-------------------------------------------------------------------
п/п| дата |тип.док/номер док| операция |счет|корр.счет|дебет|кредит
-------------------------------------------------------------------

     Написать на уровне 0/последняя запись ( └─X1 ) (отработка  по
последней записи картотеки)  строчку =================.
     Указать на уровне Detail вывод полей картотеки (зафиксировать
позицию с помощью мышки, выбрать Report, Field, выбрать <Expr...>,
указать  мышкой  поле  картотеки  для вывода в отчет с последующим
двойным нажатием кнопки мышки, OK,OK).
     Сохранить шаблон для генерации формы (отчет) под именем ksrxx
(выбрать File,  выбрать Save As,  указать требуемое  имя,  выбрать
Save, при запросе сохранения среды выбрать Yes).
     Отработать предварительный  просмотр отчета (выбрать Report,
выбрать Page Preview,  просмотреть отчет).  Отработать перемещение
полей по экрану (выбор мышкой и классическое перетаскивание).  От-
работать удаление полей (выбор поля мышкой и Delete).
     Сохранить отчет после модификации (выбрать File,  выбрать Sa-
ve).

     4.2. Создание запроса на формирование  выходной  формы  КНИГА
СЧЕТОВ.
     C использованием мышки создать запрос untitled  (непоименован-
ный) (выбрать File, выбрать Open, выбрать Type=Query, выбрать New).
     Указать выбираемую для запроса картотеку ks_.
     Добавить (связать с картотекой) картотеку cd_ по полям ks_0 и
cd_0.
     Указать поля   картотеки,  выбираемые  для  запроса  (выбрать
Select field,  указать все поля  (All)  ).  Можно  выбрать  только
необходимые, но нам это не требуется.
     Указать сортировку картотеки (выбрать Order by,  указать поля
сортировки).
     Указать вид   выходной   формы   (выбрать   Output    to    =
Report/Label).
     Указать параметры запроса  выходной  формы  (выбрать  Option,
установить  ()Report,  установить  и  указать имя ранее созданного
шаблона для генерации выходной формы ,  установить Preview report,
OK).
     После проверки выходной формы (выбрать Do  Query)  установить
параметры  выходной  формы  для  вывода  в  файл ( выбрать Option,
сбросить Preview report, установить вывод в файл To file и указать
имя файла  для  вывода  выходной формы a_ks ) Замечание:  возможен
прямой вывод на принтер,  который в рамках лабораторной работы  не
отрабатывается.   Сохранить  созданный  запрос  под  именем  ksqxx
(см.выше).
     Отработать запрос  на  формирование  выходной  формы (выбрать
Program,  выбрать Do,  указать программу на выполнение, выбрать Do
(или двойное нажатие кнопки мышки на указанной программе). Посмот-
реть сформированную выходную форму (выбрать  File,  выбрать  Open,
выбрать Type=File, указать мышкой требуемый файл с выходной формой
указанный ранее в запросе на формирование формы).

     4.3. Сформировать  "Оборотно-сальдовую  ведомость по счету...
за интервал с...  до ..."  из  ранее  созданной  формы.
    Загрузить запрос  ksqxx  (см.выше)  и сохранить его под именем
ksqosv.
     Указать новые поля для сортировки картотеки (по счету ks_s  и
дате  ks_data)  и  указать  новое  имя  выходного файла с выходной
формой (см.выше).
     Указать условие  для  выборки  записей  из картотеки (выбрать
поле в окне Field Name,  выбрать условие  Like,  указать  поле  из
картотеки Управление   работой  для  сравнения  в  окне  Example).
Сохранить  запрос  (см.выше)  Отработать  получение   и   просмотр
выходной формы (см.выше).
     Поэкспериментировать с заданием условия на выборку записей из
картотеки.
      Загрузить описание формы ksrxx (см.выше) и сохранить его под
именем ksrosv.
     Модифицировать описание   согласно  лекционного  материала  и
указать необходимые уровни отчета.

     4.4. Сформировать "Журнал-ордер по счету ... за интервал с...
до ..." из ранее  созданной  формы.
     Запрос сохранить под именем ksqjo.  Описание формы  сохранить
под именем ksrjo.

     4.5. Сформировать  "Балансовую  ведомость  по  счету  ...  за
интервал с... до ..." из ранее созданной формы.
     Запрос сохранить под именем ksqbv.  Описание формы  сохранить
под именем ksrbv.

     5.  Создание меню.
     C использованием мышки создать меню untitled  (непоименован-
ное) (выбрать File, выбрать Open, выбрать Type=Menu, выбрать New).
     В поле  Prompt (1-я строка) набрать текст Книга_счетов.  Установить
Submenu.
     В поле  Prompt (2-я строка) набрать текст ФОРМЫ.  Установить
Submenu.
     В поле  Prompt (3-я строка) набрать текст ВЫХОД.  Установить
Command. Набрать quit (это указание на выход из приложения)
     Выбрать <Create> 1-ой строки.
     В поле  Prompt  (1-я  строка  для Книга_счетов) набрать текст
КНИГА  СЧЕТОВ.  Установить  Command.  Набрать  do  kssxx.spr  (это
указание вызвать на выполнение экранную форму kssxx).
     В поле Prompt (2-я строка  для  Книга_счетов)  набрать  текст
печать книги счетов. Установить Command. Набрать do ksqxx.qpr.
     В поле Prompt (1-я строка для ФОРМЫ)  набрать  текст  Указать
параметры выходной   формы1.   Установить   Command.   Набрать  do
cdsxx.spr.
     В поле Prompt (2-я строка) набрать \-.
     В поле   Prompt   (3-я   строка   для  ФОРМЫ)  набрать  текст
Оборотно-сальдовая  ведомость.  Установить  Command.  Набрать   do
ksqosv.qpr.
     4 и 5 строки по  аналогии  сделать  печать  журнала-ордера  и
балансовой ведомости.
     В поле      Prompt     (6-я     строка)     набрать     текст
Обор-сальд.ведомость_просмотр. Установить Command.  Набрать modify
file  a_osv.txt  (это  указание  вызвать  текстовый  редактор  для
просмотра файла FIO_q.txt).
     7 и  8  строка  по аналогии сделать просмотр журнала-ордера и
балансовой ведомости.
     Выполнить предварительный просмотр меню (выбрать <Try it>)
     Сохранить меню под имение ksmxx (выбрать File,  выбрать  Save
As, указать имя, выбрать Save).
     Сгенерировать программный текст на запуск меню (выбрать Prog-
ram,  выбрать Generate,  выбрать Generate, Yes (при необходимости)
при запросе на сохранение измененного определения меню).
     Запустить меню   ksmxx.mpr   (выбрать  Program,  выбрать  Do,
указать курсором мышки программу FIO_m.mpr и дважды нажать  кнопку
мышки).

     6.  Отдыхайте на здоровье!!!

.
